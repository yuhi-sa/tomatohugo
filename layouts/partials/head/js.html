{{/* JavaScript Resources Loading Component

  Optimized JavaScript loading with:
  - Conditional loading based on content requirements
  - Performance optimizations (async, defer)
  - External dependency management
  - Production vs development handling

  @context {Page} . The current page context
  @returns {string} JavaScript script tags and configurations
*/}}

{{/* MathJax is loaded in head.html to avoid caching issues with partialCached */}}

{{/* Bootstrap JavaScript - Essential for navigation and responsive features */}}
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
  crossorigin="anonymous"
  defer
></script>

{{/* Theme-specific JavaScript */}}
{{- $darkModeJS := resources.Get "js/dark-mode.js" }}
{{- if $darkModeJS }}
  {{- $jsFile := $darkModeJS }}

  {{/* Production optimizations */}}
  {{- if eq hugo.Environment "production" }}
    {{- $jsFile = $darkModeJS | minify | fingerprint }}
  {{- end }}


  <script
    src="{{ $jsFile.RelPermalink }}"
    {{- if eq hugo.Environment "production" }}
      integrity="{{ $jsFile.Data.Integrity }}"
    {{- end }}
    defer
  ></script>
{{- end }}

{{/* Search functionality - Only load on search pages */}}
{{- if or (eq .Type "search") (.Params.search) }}
  <script>
    // Search initialization placeholder
    console.log("Search functionality ready");
  </script>
{{- end }}

{{/* Analytics and tracking - Only in production */}}
{{- if and (eq hugo.Environment "production") (.Site.Params.GoogleAnalyticsID) }}
<script>
  // Google Analytics loading deferred for performance
  window.addEventListener('load', function() {
    const script = document.createElement('script');
    script.async = true;
    script.src = 'https://www.googletagmanager.com/gtag/js?id={{ .Site.Params.GoogleAnalyticsID }}';
    document.head.appendChild(script);

    script.onload = function() {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ .Site.Params.GoogleAnalyticsID }}');
    };
  });
</script>
{{- end }}
